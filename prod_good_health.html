<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ‹æ³°äººå£½ è±ª/å¥½åº·æ„› å…¨æ–¹ä½ä¿éšœè©¦ç®—</title>
<script type="module" src="auth.js"></script>
    <style>
        :root {
            --cathay-green: #008844;
            --male-color: #1976d2;
            --female-color: #c2185b;
            --bg-gray: #f4f6f8;
            --card-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: var(--bg-gray);
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 950px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* Header */
        .header {
            background-color: var(--cathay-green);
            color: white;
            padding: 25px;
            text-align: center;
        }
        .header h1 { margin: 0; font-size: 1.8em; }
        .header p { margin: 8px 0 0; opacity: 0.9; }

        /* Controls Grid */
        .controls {
            padding: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            background: #fff;
            border-bottom: 1px solid #eee;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label { font-weight: bold; font-size: 0.95em; color: #444; }
        
        /* Gender Toggle */
        .gender-toggle {
            display: flex;
            background: #eee;
            border-radius: 8px;
            padding: 4px;
        }
        .gender-btn {
            flex: 1;
            padding: 10px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: 0.3s;
        }
        .gender-btn.active-male { background-color: var(--male-color); color: white; }
        .gender-btn.active-female { background-color: var(--female-color); color: white; }

        select, input {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
            background: #fdfdfd;
        }

        /* Premium Highlight */
        .premium-display {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: #1b5e20;
            margin-top: 10px;
        }
        .premium-val { font-size: 2em; font-weight: 800; margin: 0 5px; }

        /* Extra Benefits Section (New) */
        .benefit-section {
            padding: 25px;
            background: #fff;
        }
        .section-title {
            text-align: center;
            color: var(--cathay-green);
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            display: inline-block;
        }
        .center-title { text-align: center; }

        .benefit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .benefit-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .benefit-card:hover { transform: translateY(-3px); border-color: var(--cathay-green); }
        
        .b-icon { font-size: 2em; margin-bottom: 10px; display: block; }
        .b-title { font-weight: bold; color: #555; margin-bottom: 5px; font-size: 1.1em; }
        .b-value { font-size: 1.4em; font-weight: bold; color: #333; margin: 5px 0; }
        .b-desc { font-size: 0.85em; color: #777; line-height: 1.4; }

        /* Cancer Ranking */
        .rank-list {
            border: 1px solid #eee;
            border-radius: 12px;
            overflow: hidden;
        }
        .rank-header {
            display: flex;
            background: #f5f5f5;
            padding: 12px;
            font-weight: bold;
            color: #666;
        }
        .rank-row {
            display: flex;
            padding: 15px 12px;
            border-bottom: 1px solid #f9f9f9;
            align-items: center;
        }
        .is-specific {
            background-color: #fff8e1; /* Light Gold */
            border-left: 4px solid #ffc107;
        }
        .is-specific .col-name { color: #e65100; font-weight: bold; }
        .is-specific .col-payout { color: #d32f2f; font-weight: 800; font-size: 1.1em; }

        .col-rank { width: 50px; text-align: center; font-weight: bold; color: #aaa; }
        .col-name { flex: 1; }
        .col-payout { width: 150px; text-align: right; font-weight: bold; }

        .note {
            font-size: 0.8em;
            color: #666;
            padding: 20px 25px;
            background: #fafafa;
            border-top: 1px solid #eee;
            line-height: 1.6;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>è±ª/å¥½åº·æ„› å…¨æ–¹ä½ä¿éšœè©¦ç®—</h1>
        <p>æ•´åˆ ç™Œç—‡æ’è¡Œã€ç‰¹å®šæ‰‹è¡“ã€éª¨æŠ˜ä¿éšœ èˆ‡ æ»¿æœŸä¿è²»é€€é‚„</p>
    </div>

    <div class="controls">
        <div class="control-group">
            <label>1. é¸æ“‡å•†å“ (æ€§åˆ¥)</label>
            <div class="gender-toggle">
                <button class="gender-btn active-male" id="btnMale" onclick="setGender('male')">ç”·æ€§ (è±ªåº·æ„›)</button>
                <button class="gender-btn" id="btnFemale" onclick="setGender('female')">å¥³æ€§ (å¥½åº·æ„›)</button>
            </div>
        </div>

        <div class="control-group">
            <label>2. ç¹³è²»å¹´æœŸ</label>
            <select id="term" onchange="updateAgeOptions(); render();">
                <option value="20">20å¹´æœŸ</option>
                <option value="10">10å¹´æœŸ</option>
            </select>
        </div>

        <div class="control-group">
            <label>3. æŠ•ä¿å¹´é½¡</label>
            <select id="age" onchange="render()">
                </select>
        </div>

        <div class="control-group">
            <label>4. æŠ•ä¿ä¿é¡ (è¬å…ƒ)</label>
            <input type="number" id="coverage" value="100" step="10" min="50" max="200" oninput="render()">
        </div>

        <div class="premium-display">
            å¹´ç¹³ä¿è²»ï¼š<span class="premium-val" id="premiumLabel">0</span> å…ƒ
            <div style="font-size:0.8em; margin-top:5px; opacity:0.8;">(æœªå«è‡ªå‹•è½‰å¸³/å¥åº·ä¿ƒé€²æŠ˜æ‰£)</div>
        </div>
    </div>

    <div class="benefit-section">
        <div class="center-title">
            <span class="section-title">âœ¨ é¡å¤–åŠ å€¼ä¿éšœ</span>
        </div>
        
        <div class="benefit-grid">
            <div class="benefit-card">
                <span class="b-icon">ğŸ©º</span>
                <div class="b-title">ç‰¹å®šæ‰‹è¡“ä¿éšªé‡‘</div>
                <div class="b-value" id="valSurgery">0 è¬</div>
                <div class="b-desc" id="descSurgery">é‡å°ç‰¹å®šéƒ¨ä½æ‰‹è¡“å®šé¡çµ¦ä»˜</div>
            </div>

            <div class="benefit-card">
                <span class="b-icon">ğŸ¦´</span>
                <div class="b-title">éª¨æŠ˜ä¿éšªé‡‘</div>
                <div class="b-value" id="valFracture">æœ€é«˜ 0 è¬</div>
                <div class="b-desc">ä¾éª¨æŠ˜ç¨‹åº¦çµ¦ä»˜<br>(æœ€é«˜ä¿é¡ 8%)</div>
            </div>

            <div class="benefit-card" style="border-color: #90caf9; background: #e3f2fd;">
                <span class="b-icon">ğŸ›¡ï¸</span>
                <div class="b-title">èº«æ•…/æ»¿æœŸä¿éšªé‡‘</div>
                <div class="b-value" id="valDeath" style="color:#1565c0;">ç´„ 0 è¬</div>
                <div class="b-desc">ä¿è²»æœ‰å»æœ‰å›<br>(ç¸½ç¹³ä¿è²» 1.06å€)</div>
            </div>
        </div>

        <div class="center-title">
            <span class="section-title">ğŸ“Š å¸¸è¦‹ç™Œç—‡æ’è¡Œç†è³ </span>
        </div>
        
        <div class="rank-list">
            <div class="rank-header">
                <div class="col-rank">æ’è¡Œ</div>
                <div class="col-name">ç™Œç—‡åç¨±</div>
                <div class="col-payout">é ä¼°ç†è³ é‡‘</div>
            </div>
            <div id="rankContainer">
                </div>
        </div>
    </div>

    <div class="note">
        <p><strong>æ³¨æ„äº‹é …ï¼š</strong></p>
        <ul>
            <li><strong>ç‰¹å®šæ‰‹è¡“ (2%ä¿é¡)ï¼š</strong> 
                <span id="noteSurgery"></span>
            </li>
            <li><strong>éª¨æŠ˜ä¿éšœ (æœ€é«˜8%ä¿é¡)ï¼š</strong> ä¿‚æŒ‡å®Œå…¨éª¨æŠ˜ç‹€æ³ï¼Œè‹¥ç‚ºä¸å®Œå…¨éª¨æŠ˜æˆ–éª¨è£‚å‰‡ä¾æ¢æ¬¾æ¯”ä¾‹è¨ˆç®—ã€‚</li>
            <li><strong>èº«æ•…/æ»¿æœŸ (ç¸½ç¹³1.06å€)ï¼š</strong> éœ€æ‰£é™¤å·²é ˜å–ä¹‹å„é …ä¿éšªé‡‘ç¸½é¡ã€‚æœ¬è©¦ç®—é‡‘é¡ä»¥ã€Œå¹´ç¹³ä¿è²» Ã— å¹´æœŸ Ã— 1.06ã€ä¼°ç®—ã€‚</li>
            <li><strong>ç™Œç—‡æ’è¡Œï¼š</strong> è³‡æ–™ä¾†æºç‚ºè¡›ç”Ÿç¦åˆ©éƒ¨ 111å¹´ç™Œç—‡ç™»è¨˜å ±å‘Šã€‚</li>
            <li><strong>ç‰¹å®šç™Œç—‡ (1.5å€)ï¼š</strong> ç”·æ€§é‡å°æ”è­·è…º/çµè…¸ç›´è…¸/ç”Ÿæ®–å™¨å®˜ï¼›å¥³æ€§é‡å°ä¹³ç™Œ/å©¦ç§‘å™¨å®˜æä¾› 50% é¡å¤–åŠ çµ¦ã€‚</li>
        </ul>
    </div>
</div>

<script>
    // --- 1. Rate Data (MFA / FMB) ---
    const rates = {
        male: { // MFA
            10: { 18:412, 19:421, 20:431, 21:441, 22:451, 23:462, 24:473, 25:484, 26:495, 27:507, 28:520, 29:533, 30:545, 31:555, 32:566, 33:577, 34:589, 35:599, 36:611, 37:623, 38:635, 39:649, 40:660, 41:672, 42:685, 43:700, 44:715, 45:726, 46:739, 47:753, 48:769, 49:787, 50:800, 51:812, 52:825, 53:841, 54:859, 55:867, 56:878, 57:891, 58:908, 59:931, 60:943 },
            20: { 18:214, 19:219, 20:224, 21:230, 22:235, 23:241, 24:247, 25:253, 26:259, 27:265, 28:273, 29:280, 30:287, 31:293, 32:299, 33:306, 34:314, 35:320, 36:328, 37:336, 38:344, 39:353, 40:361, 41:370, 42:379, 43:389, 44:400, 45:409, 46:419, 47:431, 48:444, 49:459, 50:471 }
        },
        female: { // FMB
            10: { 18:418, 19:421, 20:424, 21:429, 22:434, 23:440, 24:446, 25:453, 26:461, 27:469, 28:478, 29:486, 30:494, 31:504, 32:513, 33:523, 34:532, 35:541, 36:550, 37:559, 38:568, 39:576, 40:585, 41:593, 42:602, 43:611, 44:620, 45:629, 46:638, 47:648, 48:658, 49:669, 50:680, 51:690, 52:700, 53:711, 54:722, 55:732, 56:744, 57:756, 58:769, 59:784, 60:800 },
            20: { 18:222, 19:224, 20:226, 21:228, 22:230, 23:233, 24:236, 25:240, 26:245, 27:249, 28:253, 29:258, 30:264, 31:270, 32:276, 33:282, 34:288, 35:295, 36:302, 37:309, 38:316, 39:322, 40:327, 41:333, 42:339, 43:347, 44:354, 45:361, 46:368, 47:376, 48:385, 49:395, 50:405 }
        }
    };

    // --- 2. Cancer Data ---
    const maleCancers = [
        { rank: 1, name: "æ°£ç®¡ã€æ”¯æ°£ç®¡å’Œè‚ºç™Œ", isSpecific: false },
        { rank: 2, name: "è‚å’Œè‚å…§è†½ç®¡ç™Œ", isSpecific: false },
        { rank: 3, name: "çµè…¸ã€ç›´è…¸å’Œè‚›é–€ç™Œ", isSpecific: true }, 
        { rank: 4, name: "å£è…”ç™Œ", isSpecific: false },
        { rank: 5, name: "é£Ÿé“ç™Œ", isSpecific: false },
        { rank: 6, name: "æ”è­·è…ºç™Œ", isSpecific: true }, 
        { rank: 7, name: "èƒ°è‡Ÿç™Œ", isSpecific: false },
        { rank: 8, name: "èƒƒç™Œ", isSpecific: false },
        { rank: 9, name: "éä½•æ°é‡‘æ°æ·‹å·´ç˜¤", isSpecific: false },
        { rank: 10, name: "è†€èƒ±ç™Œ", isSpecific: false }
    ];

    const femaleCancers = [
        { rank: 1, name: "æ°£ç®¡ã€æ”¯æ°£ç®¡å’Œè‚ºç™Œ", isSpecific: false },
        { rank: 2, name: "å¥³æ€§ä¹³ç™Œ", isSpecific: true }, 
        { rank: 3, name: "çµè…¸ã€ç›´è…¸å’Œè‚›é–€ç™Œ", isSpecific: false },
        { rank: 4, name: "è‚å’Œè‚å…§è†½ç®¡ç™Œ", isSpecific: false },
        { rank: 5, name: "èƒ°è‡Ÿç™Œ", isSpecific: false },
        { rank: 6, name: "èƒƒç™Œ", isSpecific: false },
        { rank: 7, name: "åµå·¢ç™Œ", isSpecific: true }, 
        { rank: 8, name: "éä½•æ°é‡‘æ°æ·‹å·´ç˜¤", isSpecific: false },
        { rank: 9, name: "å­å®®é ¸åŠæœªæ˜ç¤ºå­å®®ç™Œ", isSpecific: true }, 
        { rank: 10, name: "å­å®®é«”ç™Œ", isSpecific: true }
    ];

    let currentGender = 'male';

    function setGender(gender) {
        currentGender = gender;
        document.getElementById('btnMale').className = gender === 'male' ? 'gender-btn active-male' : 'gender-btn';
        document.getElementById('btnFemale').className = gender === 'female' ? 'gender-btn active-female' : 'gender-btn';
        render();
    }

    function updateAgeOptions() {
        const term = parseInt(document.getElementById('term').value);
        const ageSelect = document.getElementById('age');
        const currentAge = parseInt(ageSelect.value) || 30;
        
        const minAge = 18;
        const maxAge = term === 20 ? 50 : 60;

        ageSelect.innerHTML = '';
        for (let i = minAge; i <= maxAge; i++) {
            let opt = document.createElement('option');
            opt.value = i;
            opt.text = i + " æ­²";
            if (i === currentAge) opt.selected = true;
            ageSelect.appendChild(opt);
        }
        if (currentAge > maxAge) ageSelect.value = maxAge;
    }

    function render() {
        // Inputs
        const term = parseInt(document.getElementById('term').value);
        const age = parseInt(document.getElementById('age').value);
        const coverageWan = parseFloat(document.getElementById('coverage').value) || 0;
        
        // --- Premium Calc ---
        let unitRate = 0;
        try { unitRate = rates[currentGender][term][age]; } catch(e) { unitRate = 0; }
        const annualPremium = Math.round(unitRate * coverageWan);
        document.getElementById('premiumLabel').innerText = annualPremium.toLocaleString();

        // --- Extra Benefits Calc ---
        // 1. Surgery (2%)
        const valSurgery = coverageWan * 0.02;
        document.getElementById('valSurgery').innerText = valSurgery.toFixed(1) + " è¬";
        
        // Surgery Description Update
        const descSurgery = document.getElementById('descSurgery');
        const noteSurgery = document.getElementById('noteSurgery');
        if (currentGender === 'male') {
            descSurgery.innerText = "é‡å°æ”è­·è…ºç›¸é—œç‰¹å®šæ‰‹è¡“";
            noteSurgery.innerText = "ç”·æ€§é‡å°æ”è­·è…ºåˆ‡é™¤ã€åˆ®é™¤ç­‰ 8 é …ç‰¹å®šæ‰‹è¡“ã€‚";
        } else {
            descSurgery.innerText = "é‡å°å°¿å¤±ç¦ç­‰å©¦ç§‘ç‰¹å®šæ‰‹è¡“";
            noteSurgery.innerText = "å¥³æ€§é‡å°å°¿å¤±ç¦ã€è†€èƒ±æ‡¸åŠç­‰ 14 é …ç‰¹å®šæ‰‹è¡“ã€‚";
        }

        // 2. Fracture (Max 8%)
        const valFracture = coverageWan * 0.08;
        document.getElementById('valFracture').innerText = "æœ€é«˜ " + valFracture.toFixed(1) + " è¬";

        // 3. Death/Maturity (Prem * Term * 1.06)
        // Convert annualPremium to Wan for display consistency
        const totalReturnVal = (annualPremium * term * 1.06) / 10000;
        document.getElementById('valDeath').innerText = "ç´„ " + totalReturnVal.toFixed(1) + " è¬";


        // --- Cancer Ranking Render ---
        const container = document.getElementById('rankContainer');
        container.innerHTML = '';
        let data = (currentGender === 'male') ? maleCancers : femaleCancers;

        data.forEach(item => {
            const multiplier = item.isSpecific ? 1.5 : 1.0;
            const payout = coverageWan * multiplier;

            const row = document.createElement('div');
            row.className = `rank-row ${item.isSpecific ? 'is-specific' : ''}`;
            
            // Add specific label if specific
            const nameHtml = item.isSpecific ? 
                `${item.name} <span style="font-size:0.8em; color:#e65100;">(ç‰¹å®š)</span>` : 
                item.name;

            row.innerHTML = `
                <div class="col-rank">${item.rank}</div>
                <div class="col-name">${nameHtml}</div>
                <div class="col-payout">${payout.toLocaleString()} è¬</div>
            `;
            container.appendChild(row);
        });
    }

    // Init
    updateAgeOptions();
    render();
</script>

</body>
</html>